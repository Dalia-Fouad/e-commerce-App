import{a as y}from"./chunk-YT3NGYPD.js";import{a as T,b as _,c as V,d as M,h as q,i as N,j as R,k as A,m as G}from"./chunk-TFPA5QCA.js";import{g as b}from"./chunk-ZARZFIJP.js";import{Cb as l,Db as F,Jb as h,Mb as S,Na as s,Z as C,aa as P,db as u,fb as p,jb as c,jc as E,ka as f,la as w,nb as n,ob as i,pb as g,sb as x,ub as v,vb as m}from"./chunk-VV2C2VWU.js";var D=(o,r)=>({"is-valid":o,"is-invalid":r});function B(o,r){o&1&&(n(0,"p",11),l(1,"email is required"),i())}function I(o,r){o&1&&(n(0,"p",11),l(1,"Enter Valid Email "),i())}function k(o,r){if(o&1&&(n(0,"div",7),u(1,B,2,0,"p",11)(2,I,2,0),i()),o&2){let e,t=m(2);s(),c(1,(e=t.forgotPasswordForm.get("email"))!=null&&e.getError("required")?1:(e=t.forgotPasswordForm.get("email"))!=null&&e.getError("email")?2:-1)}}function $(o,r){if(o&1&&(n(0,"div",10),l(1),i()),o&2){let e=m(2);s(),F(e.errorMessage)}}function j(o,r){if(o&1){let e=x();n(0,"form",3),v("ngSubmit",function(){f(e);let d=m();return w(d.verifyEmail())}),n(1,"div",4)(2,"label",5),l(3,"Enter Your Email :"),i(),g(4,"input",6),u(5,k,3,1,"div",7),i(),n(6,"span",8),l(7," a verfication code will be sent to this email "),i(),n(8,"button",9),l(9," Next "),i(),u(10,$,2,1,"div",10),i()}if(o&2){let e,t=m();p("formGroup",t.forgotPasswordForm),s(5),c(5,(e=t.forgotPasswordForm.get("email"))!=null&&e.errors&&((e=t.forgotPasswordForm.get("email"))!=null&&e.touched||(e=t.forgotPasswordForm.get("email"))!=null&&e.dirty)?5:-1),s(3),p("disabled",t.isloading||t.forgotPasswordForm.invalid),s(2),c(10,t.errorMessage?10:-1)}}function O(o,r){o&1&&(n(0,"p",11),l(1,"resetCode is required"),i())}function U(o,r){o&1&&(n(0,"p",11),l(1,"Enter Valid Code "),i())}function Y(o,r){if(o&1&&(n(0,"div",7),u(1,O,2,0,"p",11)(2,U,2,0),i()),o&2){let e,t=m(2);s(),c(1,(e=t.verifyCodeForm.get("resetCode"))!=null&&e.getError("required")?1:(e=t.verifyCodeForm.get("resetCode"))!=null&&e.getError("pattern")?2:-1)}}function z(o,r){if(o&1&&(n(0,"div",10),l(1),i()),o&2){let e=m(2);s(),F(e.errorMessage)}}function H(o,r){if(o&1){let e=x();n(0,"form",3),v("ngSubmit",function(){f(e);let d=m();return w(d.verifyResetCode())}),n(1,"div",4)(2,"label",12),l(3,"Enter verfication code :"),i(),g(4,"input",13),u(5,Y,3,1,"div",7),i(),n(6,"button",9),l(7," next "),i(),u(8,z,2,1,"div",10),i()}if(o&2){let e,t=m();p("formGroup",t.verifyCodeForm),s(5),c(5,(e=t.verifyCodeForm.get("resetCode"))!=null&&e.errors&&((e=t.verifyCodeForm.get("resetCode"))!=null&&e.touched||(e=t.verifyCodeForm.get("resetCode"))!=null&&e.dirty)?5:-1),s(),p("disabled",t.isloading),s(2),c(8,t.errorMessage?8:-1)}}function J(o,r){o&1&&(n(0,"p",11),l(1,"email is required"),i())}function K(o,r){o&1&&(n(0,"p",11),l(1,"Enter Valid Email "),i())}function L(o,r){if(o&1&&(n(0,"div",7),u(1,J,2,0,"p",11)(2,K,2,0),i()),o&2){let e,t=m(2);s(),c(1,(e=t.resetPasswordForm.get("email"))!=null&&e.getError("required")?1:(e=t.resetPasswordForm.get("email"))!=null&&e.getError("email")?2:-1)}}function Q(o,r){o&1&&(n(0,"p",11),l(1,"password is required"),i())}function W(o,r){o&1&&(n(0,"p",11),l(1,"must be at least 6 chars"),i())}function X(o,r){if(o&1&&(n(0,"div",7),u(1,Q,2,0,"p",11)(2,W,2,0),i()),o&2){let e,t=m(2);s(),c(1,(e=t.resetPasswordForm.get("newPassword"))!=null&&e.getError("required")?1:(e=t.resetPasswordForm.get("newPassword"))!=null&&e.getError("pattern")?2:-1)}}function Z(o,r){if(o&1&&(n(0,"div",10),l(1),i()),o&2){let e=m(2);s(),F(e.errorMessage)}}function ee(o,r){if(o&1){let e=x();n(0,"form",3),v("ngSubmit",function(){f(e);let d=m();return w(d.resetPassword())}),n(1,"div",4)(2,"label",14),l(3,"email:"),i(),g(4,"input",15),u(5,L,3,1,"div",7),i(),n(6,"div",4)(7,"label",16),l(8,"new password:"),i(),g(9,"input",17),u(10,X,3,1,"div",7),i(),n(11,"button",9),l(12," Reset Password "),i(),u(13,Z,2,1,"div",10),i()}if(o&2){let e,t,d,a=m();p("formGroup",a.resetPasswordForm),s(4),p("ngClass",S(6,D,!((e=a.resetPasswordForm.get("email"))!=null&&e.errors)&&(((e=a.resetPasswordForm.get("email"))==null?null:e.touched)||((e=a.resetPasswordForm.get("email"))==null?null:e.dirty)),((e=a.resetPasswordForm.get("email"))==null?null:e.errors)&&(((e=a.resetPasswordForm.get("email"))==null?null:e.touched)||((e=a.resetPasswordForm.get("email"))==null?null:e.dirty)))),s(),c(5,(t=a.resetPasswordForm.get("email"))!=null&&t.errors&&((t=a.resetPasswordForm.get("email"))!=null&&t.touched||(t=a.resetPasswordForm.get("email"))!=null&&t.dirty)?5:-1),s(5),c(10,(d=a.resetPasswordForm.get("newPassword"))!=null&&d.errors&&((d=a.resetPasswordForm.get("newPassword"))!=null&&d.touched||(d=a.resetPasswordForm.get("newPassword"))!=null&&d.dirty)?10:-1),s(),p("disabled",a.isloading),s(2),c(13,a.errorMessage?13:-1)}}var de=(()=>{let r=class r{constructor(){this._FormBuilder=C(A),this._AuthService=C(y),this._Router=C(b),this.step=1,this.isloading=!1,this.errorMessage="",this.forgotPasswordForm=this._FormBuilder.group({email:[null,[_.required,_.email]]}),this.verifyCodeForm=this._FormBuilder.group({resetCode:[null,[_.required,_.pattern(/^\w{6}$/)]]}),this.resetPasswordForm=this._FormBuilder.group({email:[null,[_.required,_.email]],newPassword:[null,[_.required,_.pattern(/^\w{6,}$/)]]})}verifyEmail(){this.isloading=!0,this.resetPasswordForm.get("email")?.patchValue(this.forgotPasswordForm.get("email")?.value),this.Subscrip1=this._AuthService.forgotPassword(this.forgotPasswordForm.value).subscribe({next:t=>{this.isloading=!1,console.log(t),t.statusMsg==="success"&&(this.step=2)},error:t=>{this.isloading=!1,console.log(t.error.message),this.errorMessage=t.error.message}})}verifyResetCode(){this.Subscrip2=this._AuthService.verifyResetCode(this.verifyCodeForm.value).subscribe({next:t=>{console.log(t),t.status==="Success"&&(this.step=3)},error:t=>{console.log(t.error.message),this.errorMessage=t.error.message}})}resetPassword(){this.Subscrip3=this._AuthService.resetPassword(this.resetPasswordForm.value).subscribe({next:t=>{console.log(t),localStorage.setItem("userToken",t.token),this._AuthService.saveUserData(),this._Router.navigate(["/home"])},error:t=>{console.log(t.error.message),this.errorMessage=t.error.message}})}ngOnDestroy(){this.Subscrip1?.unsubscribe(),this.Subscrip2?.unsubscribe(),this.Subscrip3?.unsubscribe()}};r.\u0275fac=function(d){return new(d||r)},r.\u0275cmp=P({type:r,selectors:[["app-forgot-password"]],standalone:!0,features:[h],decls:7,vars:1,consts:[[1,"container","w-50","bg-light","rounded-3","p-4","shadow"],[1,"text-main","fw-bold","text-center","mb-4"],[3,"formGroup"],[3,"ngSubmit","formGroup"],[1,"my-2"],["for","email",1,"fw-bold"],["type","text","id","email","formControlName","email",1,"form-control"],[1,"alert","alert-danger","w-100","mt-1"],[1,"small","mb-3"],["type","submit",1,"btn-main","w-100","my-3",3,"disabled"],[1,"alert","alert-danger"],[1,"m-0"],["for","resetCode",1,"fw-bold"],["type","text","id","resetCode","formControlName","resetCode",1,"form-control"],["for","email"],["readonly","","type","text","id","email","formControlName","email",1,"form-control",3,"ngClass"],["for","newPassword"],["type","password","id","newPassword","formControlName","newPassword",1,"form-control"]],template:function(d,a){d&1&&(n(0,"section")(1,"div",0)(2,"h4",1),l(3,"Forgot your password"),i(),u(4,j,11,4,"form",2)(5,H,9,4)(6,ee,14,9),i()()),d&2&&(s(4),c(4,a.step==1?4:a.step==2?5:a.step==3?6:-1))},dependencies:[G,q,T,V,M,N,R,E]});let o=r;return o})();export{de as ForgotPasswordComponent};
